{{-
    config(
        materialized = "incremental",
        unique_key = "ingestion_sk",
        tags = ["execute_daily"]
    )
-}}


SELECT
    {{
        dbt_utils.generate_surrogate_key([
            "patient.age",
            "patient.ageday",
            "patient.agemonth",
            "patient.ageyear",
            "patient.barcode",
            "patient.birthdate",
            "patient.cellnumber",
            "patient.childage0to1",
            "patient.childage1to5",
            "patient.childageover5",
            "patient.childrennumber",
            "patient.createdate",
            "patient.createuser",
            "patient.educationid",
            "patient.emailaddress",
            "patient.familymembers",
            "patient.familyname",
            "patient.fathername",
            "patient.fingerprint",
            "patient.genderid",
            "patient.givenname",
            "patient.headoffamilyid",
            "patient.idnumber",
            "patient.idowner",
            "patient.idtype",
            "patient.iscalculatedbirthday",
            "patient.joiningdate",
            "patient.maritalstatusid",
            "patient.mothername",
            "patient.orgid",
            "patient.patientcode",
            "patient.patientid",
            "patient.patientimage",
            "patient.refdepartmentid",
            "patient.refdesignationid",
            "patient.registrationid",
            "patient.religionid",
            "patient.spousename",
            "patient.stationstatus",
            "patient.status",
            "patient.updatedate",
            "patient.updateuser",
            "patient.usersid",
            "patient.workplacebranchid",
            "patient.workplaceid"
        ])
    }} AS ingestion_sk,
    patient.age,
    patient.ageday,
    patient.agemonth,
    patient.ageyear,
    patient.barcode,
    patient.birthdate,
    patient.cellnumber,
    patient.childage0to1,
    patient.childage1to5,
    patient.childageover5,
    patient.childrennumber,
    patient.createdate,
    patient.createuser,
    patient.educationid,
    patient.emailaddress,
    patient.familymembers,
    patient.familyname,
    patient.fathername,
    patient.fingerprint,
    patient.genderid,
    patient.givenname,
    patient.headoffamilyid,
    patient.idnumber,
    patient.idowner,
    patient.idtype,
    patient.iscalculatedbirthday,
    patient.joiningdate,
    patient.maritalstatusid,
    patient.mothername,
    patient.orgid,
    patient.patientcode,
    patient.patientid,
    patient.patientimage,
    patient.refdepartmentid,
    patient.refdesignationid,
    patient.registrationid,
    patient.religionid,
    patient.spousename,
    patient.stationstatus,
    patient.status,
    patient.updatedate,
    patient.updateuser,
    patient.usersid,
    patient.workplacebranchid,
    patient.workplaceid

FROM
    {{ source("bay_dbo", "patient") }} AS patient
