{{-
    config(
        materialized = "incremental",
        unique_key = "ingestion_sk",
        tags = ["execute_daily"]
    )
-}}


SELECT
    {{
        dbt_utils.generate_surrogate_key([
            "`age`",
            "`ageday`",
            "`agemonth`",
            "`ageyear`",
            "`barcode`",
            "`birthdate`",
            "`cellnumber`",
            "`childage0to1`",
            "`childage1to5`",
            "`childageover5`",
            "`childrennumber`",
            "`createdate`",
            "`createuser`",
            "`educationid`",
            "`emailaddress`",
            "`familymembers`",
            "`familyname`",
            "`fathername`",
            "`fingerprint`",
            "`genderid`",
            "`givenname`",
            "`headoffamilyid`",
            "`idnumber`",
            "`idowner`",
            "`idtype`",
            "`iscalculatedbirthday`",
            "`joiningdate`",
            "`maritalstatusid`",
            "`mothername`",
            "`orgid`",
            "`patientcode`",
            "`patientid`",
            "`patientimage`",
            "`refdepartmentid`",
            "`refdesignationid`",
            "`registrationid`",
            "`religionid`",
            "`spousename`",
            "`stationstatus`",
            "`status`",
            "`updatedate`",
            "`updateuser`",
            "`usersid`",
            "`workplacebranchid`",
            "`workplaceid`"
        ])
    }} AS `ingestion_sk`,
    `age`,
    `ageday`,
    `agemonth`,
    `ageyear`,
    `barcode`,
    `birthdate`,
    `cellnumber`,
    `childage0to1`,
    `childage1to5`,
    `childageover5`,
    `childrennumber`,
    `createdate`,
    `createuser`,
    `educationid`,
    `emailaddress`,
    `familymembers`,
    `familyname`,
    `fathername`,
    `fingerprint`,
    `genderid`,
    `givenname`,
    `headoffamilyid`,
    `idnumber`,
    `idowner`,
    `idtype`,
    `iscalculatedbirthday`,
    `joiningdate`,
    `maritalstatusid`,
    `mothername`,
    `orgid`,
    `patientcode`,
    `patientid`,
    `patientimage`,
    `refdepartmentid`,
    `refdesignationid`,
    `registrationid`,
    `religionid`,
    `spousename`,
    `stationstatus`,
    `status`,
    `updatedate`,
    `updateuser`,
    `usersid`,
    `workplacebranchid`,
    `workplaceid`

FROM
    {{ source("bay_dbo", "patient") }}
