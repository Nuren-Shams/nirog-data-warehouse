{{-
    config(
        materialized = "incremental",
        unique_key = "ingestion_sk",
        tags = ["execute_daily"]
    )
-}}


SELECT
    {{
        dbt_utils.generate_surrogate_key([
            "patient_s.age",
            "patient_s.ageday",
            "patient_s.agemonth",
            "patient_s.ageyear",
            "patient_s.barcode",
            "patient_s.birthdate",
            "patient_s.cellnumber",
            "patient_s.childage0to1",
            "patient_s.childage1to5",
            "patient_s.childageover5",
            "patient_s.childrennumber",
            "patient_s.createdate",
            "patient_s.createuser",
            "patient_s.educationid",
            "patient_s.emailaddress",
            "patient_s.familymembers",
            "patient_s.familyname",
            "patient_s.fathername",
            "patient_s.fingerprint",
            "patient_s.genderid",
            "patient_s.givenname",
            "patient_s.headoffamilyid",
            "patient_s.idnumber",
            "patient_s.idowner",
            "patient_s.idtype",
            "patient_s.iscalculatedbirthday",
            "patient_s.joiningdate",
            "patient_s.maritalstatusid",
            "patient_s.mothername",
            "patient_s.orgid",
            "patient_s.patientcode",
            "patient_s.patientid",
            "patient_s.patientimage",
            "patient_s.refdepartmentid",
            "patient_s.refdesignationid",
            "patient_s.registrationid",
            "patient_s.religionid",
            "patient_s.spousename",
            "patient_s.stationstatus",
            "patient_s.status",
            "patient_s.updatedate",
            "patient_s.updateuser",
            "patient_s.usersid",
            "patient_s.workplacebranchid",
            "patient_s.workplaceid"
        ])
    }} AS ingestion_sk,
    patient_s.age,
    patient_s.ageday,
    patient_s.agemonth,
    patient_s.ageyear,
    patient_s.barcode,
    patient_s.birthdate,
    patient_s.cellnumber,
    patient_s.childage0to1,
    patient_s.childage1to5,
    patient_s.childageover5,
    patient_s.childrennumber,
    patient_s.createdate,
    patient_s.createuser,
    patient_s.educationid,
    patient_s.emailaddress,
    patient_s.familymembers,
    patient_s.familyname,
    patient_s.fathername,
    patient_s.fingerprint,
    patient_s.genderid,
    patient_s.givenname,
    patient_s.headoffamilyid,
    patient_s.idnumber,
    patient_s.idowner,
    patient_s.idtype,
    patient_s.iscalculatedbirthday,
    patient_s.joiningdate,
    patient_s.maritalstatusid,
    patient_s.mothername,
    patient_s.orgid,
    patient_s.patientcode,
    patient_s.patientid,
    patient_s.patientimage,
    patient_s.refdepartmentid,
    patient_s.refdesignationid,
    patient_s.registrationid,
    patient_s.religionid,
    patient_s.spousename,
    patient_s.stationstatus,
    patient_s.status,
    patient_s.updatedate,
    patient_s.updateuser,
    patient_s.usersid,
    patient_s.workplacebranchid,
    patient_s.workplaceid

FROM
    {{ source("bay_dbo", "patient_s") }} AS patient_s
