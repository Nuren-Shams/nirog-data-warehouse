{{-
    config(
        materialized = "incremental",
        unique_key = "ingestion_sk",
        tags = ["execute_daily"]
    )
-}}


SELECT
    {{
        dbt_utils.generate_surrogate_key([
            "`age`",
            "`ageday`",
            "`agemonth`",
            "`ageyear`",
            "`anemiaseverity`",
            "`birthdate`",
            "`bmi`",
            "`bmistatus`",
            "`bpdiastolic1`",
            "`bpdiastolic2`",
            "`bpsystolic1`",
            "`bpsystolic2`",
            "`chiefcomplain_and_duration`",
            "`childmortality0to1`",
            "`childmortalitybelow5`",
            "`childmortalityover5`",
            "`collectiondate`",
            "`contraceptionmethod`",
            "`coughgreaterthanmonth`",
            "`createuser`",
            "`diagnosticsuggestion`",
            "`edemaseverity`",
            "`employeeid`",
            "`familyillnesshistory`",
            "`familyname`",
            "`fbg`",
            "`followupdate`",
            "`gender`",
            "`gendercode`",
            "`genderid`",
            "`givenname`",
            "`gravida`",
            "`heartrate`",
            "`heartwithnad`",
            "`height`",
            "`hemoglobin`",
            "`hrsfromlasteat`",
            "`iscervicalcancer`",
            "`ischildrenoverweight`",
            "`ischildrenunderweight`",
            "`isheartwithnad`",
            "`islungswithnad`",
            "`islymphnodeswithpalpable`",
            "`ispregnant`",
            "`jaundiceseverity`",
            "`lgerf`",
            "`livingbirth`",
            "`livingfemale`",
            "`livingmale`",
            "`lmp`",
            "`lungswithnad`",
            "`lymphnodeswithpalpablesite`",
            "`lymphnodeswithpalpablesize`",
            "`mdprovisionaldiagnosisid`",
            "`menstruationproduct`",
            "`menstruationproductusagetime`",
            "`miscarraigeorabortion`",
            "`mr`",
            "`muac`",
            "`muacstatus`",
            "`nightsweat`",
            "`othercontraceptionmethod`",
            "`othermenstruationproduct`",
            "`othermenstruationproductusagetime`",
            "`patientcode`",
            "`patientid`",
            "`patientillnesshistory`",
            "`physicalfinding`",
            "`provisionaldiagnosis`",
            "`rbg`",
            "`referral`",
            "`rxdetails`",
            "`socialbehaviorhistory`",
            "`stillbirth`",
            "`thermocoagulationstatus`",
            "`treatmentsuggestions`",
            "`updateuser`",
            "`vaccination`",
            "`weight`",
            "`weightloss`",
            "`workplacebranchid`",
            "`workplacebranchname`",
            "`workplaceid`",
            "`workplacename`"
        ])
    }} AS `ingestion_sk`,
    `age`,
    `ageday`,
    `agemonth`,
    `ageyear`,
    `anemiaseverity`,
    `birthdate`,
    `bmi`,
    `bmistatus`,
    `bpdiastolic1`,
    `bpdiastolic2`,
    `bpsystolic1`,
    `bpsystolic2`,
    `chiefcomplain_and_duration`,
    `childmortality0to1`,
    `childmortalitybelow5`,
    `childmortalityover5`,
    `collectiondate`,
    `contraceptionmethod`,
    `coughgreaterthanmonth`,
    `createuser`,
    `diagnosticsuggestion`,
    `edemaseverity`,
    `employeeid`,
    `familyillnesshistory`,
    `familyname`,
    `fbg`,
    `followupdate`,
    `gender`,
    `gendercode`,
    `genderid`,
    `givenname`,
    `gravida`,
    `heartrate`,
    `heartwithnad`,
    `height`,
    `hemoglobin`,
    `hrsfromlasteat`,
    `iscervicalcancer`,
    `ischildrenoverweight`,
    `ischildrenunderweight`,
    `isheartwithnad`,
    `islungswithnad`,
    `islymphnodeswithpalpable`,
    `ispregnant`,
    `jaundiceseverity`,
    `lgerf`,
    `livingbirth`,
    `livingfemale`,
    `livingmale`,
    `lmp`,
    `lungswithnad`,
    `lymphnodeswithpalpablesite`,
    `lymphnodeswithpalpablesize`,
    `mdprovisionaldiagnosisid`,
    `menstruationproduct`,
    `menstruationproductusagetime`,
    `miscarraigeorabortion`,
    `mr`,
    `muac`,
    `muacstatus`,
    `nightsweat`,
    `othercontraceptionmethod`,
    `othermenstruationproduct`,
    `othermenstruationproductusagetime`,
    `patientcode`,
    `patientid`,
    `patientillnesshistory`,
    `physicalfinding`,
    `provisionaldiagnosis`,
    `rbg`,
    `referral`,
    `rxdetails`,
    `socialbehaviorhistory`,
    `stillbirth`,
    `thermocoagulationstatus`,
    `treatmentsuggestions`,
    `updateuser`,
    `vaccination`,
    `weight`,
    `weightloss`,
    `workplacebranchid`,
    `workplacebranchname`,
    `workplaceid`,
    `workplacename`

FROM
    {{ source("bay_dbo", "rptprocess") }}
