{{-
    config(
        materialized = "incremental",
        unique_key = "ingestion_sk",
        tags = ["execute_daily"]
    )
-}}


SELECT
    {{
        dbt_utils.generate_surrogate_key([
            "rptprocess.age",
            "rptprocess.ageday",
            "rptprocess.agemonth",
            "rptprocess.ageyear",
            "rptprocess.anemiaseverity",
            "rptprocess.birthdate",
            "rptprocess.bmi",
            "rptprocess.bmistatus",
            "rptprocess.bpdiastolic1",
            "rptprocess.bpdiastolic2",
            "rptprocess.bpsystolic1",
            "rptprocess.bpsystolic2",
            "rptprocess.chiefcomplain_and_duration",
            "rptprocess.childmortality0to1",
            "rptprocess.childmortalitybelow5",
            "rptprocess.childmortalityover5",
            "rptprocess.collectiondate",
            "rptprocess.contraceptionmethod",
            "rptprocess.coughgreaterthanmonth",
            "rptprocess.createuser",
            "rptprocess.diagnosticsuggestion",
            "rptprocess.edemaseverity",
            "rptprocess.employeeid",
            "rptprocess.familyillnesshistory",
            "rptprocess.familyname",
            "rptprocess.fbg",
            "rptprocess.followupdate",
            "rptprocess.gender",
            "rptprocess.gendercode",
            "rptprocess.genderid",
            "rptprocess.givenname",
            "rptprocess.gravida",
            "rptprocess.heartrate",
            "rptprocess.heartwithnad",
            "rptprocess.height",
            "rptprocess.hemoglobin",
            "rptprocess.hrsfromlasteat",
            "rptprocess.iscervicalcancer",
            "rptprocess.ischildrenoverweight",
            "rptprocess.ischildrenunderweight",
            "rptprocess.isheartwithnad",
            "rptprocess.islungswithnad",
            "rptprocess.islymphnodeswithpalpable",
            "rptprocess.ispregnant",
            "rptprocess.jaundiceseverity",
            "rptprocess.lgerf",
            "rptprocess.livingbirth",
            "rptprocess.livingfemale",
            "rptprocess.livingmale",
            "rptprocess.lmp",
            "rptprocess.lungswithnad",
            "rptprocess.lymphnodeswithpalpablesite",
            "rptprocess.lymphnodeswithpalpablesize",
            "rptprocess.mdprovisionaldiagnosisid",
            "rptprocess.menstruationproduct",
            "rptprocess.menstruationproductusagetime",
            "rptprocess.miscarraigeorabortion",
            "rptprocess.mr",
            "rptprocess.muac",
            "rptprocess.muacstatus",
            "rptprocess.nightsweat",
            "rptprocess.othercontraceptionmethod",
            "rptprocess.othermenstruationproduct",
            "rptprocess.othermenstruationproductusagetime",
            "rptprocess.patientcode",
            "rptprocess.patientid",
            "rptprocess.patientillnesshistory",
            "rptprocess.physicalfinding",
            "rptprocess.provisionaldiagnosis",
            "rptprocess.rbg",
            "rptprocess.referral",
            "rptprocess.rxdetails",
            "rptprocess.socialbehaviorhistory",
            "rptprocess.stillbirth",
            "rptprocess.thermocoagulationstatus",
            "rptprocess.treatmentsuggestions",
            "rptprocess.updateuser",
            "rptprocess.vaccination",
            "rptprocess.weight",
            "rptprocess.weightloss",
            "rptprocess.workplacebranchid",
            "rptprocess.workplacebranchname",
            "rptprocess.workplaceid",
            "rptprocess.workplacename"
        ])
    }} AS ingestion_sk,
    rptprocess.age,
    rptprocess.ageday,
    rptprocess.agemonth,
    rptprocess.ageyear,
    rptprocess.anemiaseverity,
    rptprocess.birthdate,
    rptprocess.bmi,
    rptprocess.bmistatus,
    rptprocess.bpdiastolic1,
    rptprocess.bpdiastolic2,
    rptprocess.bpsystolic1,
    rptprocess.bpsystolic2,
    rptprocess.chiefcomplain_and_duration,
    rptprocess.childmortality0to1,
    rptprocess.childmortalitybelow5,
    rptprocess.childmortalityover5,
    rptprocess.collectiondate,
    rptprocess.contraceptionmethod,
    rptprocess.coughgreaterthanmonth,
    rptprocess.createuser,
    rptprocess.diagnosticsuggestion,
    rptprocess.edemaseverity,
    rptprocess.employeeid,
    rptprocess.familyillnesshistory,
    rptprocess.familyname,
    rptprocess.fbg,
    rptprocess.followupdate,
    rptprocess.gender,
    rptprocess.gendercode,
    rptprocess.genderid,
    rptprocess.givenname,
    rptprocess.gravida,
    rptprocess.heartrate,
    rptprocess.heartwithnad,
    rptprocess.height,
    rptprocess.hemoglobin,
    rptprocess.hrsfromlasteat,
    rptprocess.iscervicalcancer,
    rptprocess.ischildrenoverweight,
    rptprocess.ischildrenunderweight,
    rptprocess.isheartwithnad,
    rptprocess.islungswithnad,
    rptprocess.islymphnodeswithpalpable,
    rptprocess.ispregnant,
    rptprocess.jaundiceseverity,
    rptprocess.lgerf,
    rptprocess.livingbirth,
    rptprocess.livingfemale,
    rptprocess.livingmale,
    rptprocess.lmp,
    rptprocess.lungswithnad,
    rptprocess.lymphnodeswithpalpablesite,
    rptprocess.lymphnodeswithpalpablesize,
    rptprocess.mdprovisionaldiagnosisid,
    rptprocess.menstruationproduct,
    rptprocess.menstruationproductusagetime,
    rptprocess.miscarraigeorabortion,
    rptprocess.mr,
    rptprocess.muac,
    rptprocess.muacstatus,
    rptprocess.nightsweat,
    rptprocess.othercontraceptionmethod,
    rptprocess.othermenstruationproduct,
    rptprocess.othermenstruationproductusagetime,
    rptprocess.patientcode,
    rptprocess.patientid,
    rptprocess.patientillnesshistory,
    rptprocess.physicalfinding,
    rptprocess.provisionaldiagnosis,
    rptprocess.rbg,
    rptprocess.referral,
    rptprocess.rxdetails,
    rptprocess.socialbehaviorhistory,
    rptprocess.stillbirth,
    rptprocess.thermocoagulationstatus,
    rptprocess.treatmentsuggestions,
    rptprocess.updateuser,
    rptprocess.vaccination,
    rptprocess.weight,
    rptprocess.weightloss,
    rptprocess.workplacebranchid,
    rptprocess.workplacebranchname,
    rptprocess.workplaceid,
    rptprocess.workplacename

FROM
    {{ source("bay_dbo", "rptprocess") }} AS rptprocess
